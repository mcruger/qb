<script>
//initializes game for play
//hides everything and starts timer



$( document ).ready(function() {

	var questionIDs = new Array();
	var is_first = true;
	var cur_classID;

	$('.question').each( function(i,e) { 
		cur_classID = "";
    	cur_classID = $(e).attr('id');

    	questionIDs.push(cur_classID);
		if(is_first != true){
			$("div#"+cur_classID).toggle();
		}
		is_first = false;
	});
	
//start timer - this is the game's total time to be played
//each question will then run on a separate timer that will handle the "peeling off" of wrong answers

//need a global var to denote what question the interval is on. 
q_index_GLOBAL = 0;
q_index_max_GLOBAL = questionIDs.length;
var intervalVal = 3000;
var intervalID=setInterval(function(){displayQuestion(questionIDs,intervalID, intervalVal)}, intervalVal);

});


//interval function that times each question
function displayQuestion(questionIDs, intervalID, intervalVal)
{
	//init blank array to store question IDs
	//for *this question 
	var answerIDs = new Array();
	var numAnswers;
	if(q_index_GLOBAL != q_index_max_GLOBAL){
		//ever interval, hide current div, show next div
		$("#"+questionIDs[q_index_GLOBAL]).toggle();
		$("#"+questionIDs[(q_index_GLOBAL+1)]).toggle();

		//get all answer values for this question
		//note class syntax matches answer class - answer_q_id
		$('.answer_'+questionIDs[q_index_GLOBAL]).each( function(i,e) {
				cur_classID = "";
    			cur_classID = $(e).attr('id');
    			//only grab answers that are incorrect (we're peeling them off)
    			if(cur_classID.indexOf("True") === false){
	    			answerIDs.push(cur_classID);
	    		}
		});

		numAnswers = answerIDs.length;

		//peel off incorrect answers in set time increments
		while(numAnswers != 0){
			setTimeout(function(){alert(answerIDs[numAnswers])}, 1000);

		}		

		q_index_GLOBAL++;
	}else{
		alert("END OF GAME");
		clearInterval(intervalID);
	}
}


</script>

<% @questions.each do |q| %>
	
	<div class="question" id='q_<%=q.id%>'>
	<h1><%= q.question %></h1>
	<!--need to get all answers for this question (by quesiton_id)-->
	<br>
	 <% q.answers.each do |a| %>
	 
	 	<%= radio_button_tag q.id.to_s(), a.id.to_s()+'_'+a.is_correct.to_s() %>
	 	<!-- note that answer_q_id is used for class
	 	so we can easily grab all answers -->
	   <span class="answer_q_<%=q.id%>" id='<%=a.id%>_<%=a.is_correct%>'><%= a.answer %></span>

       <br>
    <% end %>
	</div>
	<br>
	<br>
<% end %>

